#include "catch.hpp"
#include "test_utils.hpp"

#include <vector>
#include <memory>
#include <evm/hash.hpp>
#include <evm/big_int.hpp>
#include <evm/utils.hpp>
#include <evm/hex.hpp>

TEST_CASE("bytesWordToHex", "[hash]" ) {

  // given
  bytes_t hexBytes = Hex::hexToBytes("00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005");

  // then
  CHECK("0000000000000000000000000000000000000000000000000000000000000001" == 
    Hex::bytesWordToHex(hexBytes, 0)
  );

  CHECK("0000000000000000000000000000000000000000000000000000000000000002" == 
    Hex::bytesWordToHex(hexBytes, 32)
  );

  CHECK("0000000000000000000000000000000000000000000000000000000000000003" == 
    Hex::bytesWordToHex(hexBytes, 64)
  );

  CHECK("0000000000000000000000000000000000000000000000000000000000000004" == 
    Hex::bytesWordToHex(hexBytes, 96)
  );

  CHECK("0000000000000000000000000000000000000000000000000000000000000005" == 
    Hex::bytesWordToHex(hexBytes, 128)
  );
}

TEST_CASE("bytesToWordOutput", "[hash]" ) {

  // given
  bytes_t hexBytes = Hex::hexToBytes("00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000005");

  // then
  CHECK("[0000000000000000000000000000000000000000000000000000000000000001,0000000000000000000000000000000000000000000000000000000000000002,0000000000000000000000000000000000000000000000000000000000000003,0000000000000000000000000000000000000000000000000000000000000004,0000000000000000000000000000000000000000000000000000000000000005]" == 
    Hex::bytesToWordOutput(hexBytes, 0, hexBytes.size())
  );

  CHECK("[0000000000000000000000000000000000000000000000000000000000000003]" == 
    Hex::bytesToWordOutput(hexBytes, 64, 32)
  );

  CHECK("[0000000000000000000000000000000000000000000000000000000000000004,0000000000000000000000000000000000000000000000000000000000000005]" == 
    Hex::bytesToWordOutput(hexBytes, 96, 64)
  );

  CHECK("[]" == 
    Hex::bytesToWordOutput(hexBytes, 128, 61)
  );

  CHECK("[]" == 
    Hex::bytesToWordOutput(hexBytes, 320, 32)
  );
}